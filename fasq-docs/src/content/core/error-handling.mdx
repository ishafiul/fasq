# Error Handling

Fasq provides robust error handling to ensure your app recovers gracefully from network failures or exceptions.

## Usage

Errors are exposed in the `QueryState`.

```dart
QueryBuilder<User>(
  queryKey: 'user'.toQueryKey(),
  queryFn: () => throw Exception('Network failed'),
  builder: (context, state) {
    if (state.hasError) {
      return Text('Error: ${state.error}');
    }
    return Text('Data: ${state.data}');
  },
)
```

## API

### Configuration Options

| Option | Type | Description |
|--------|------|-------------|
| `retry` | `int` | Number of times to retry failed requests. Default is `3`. |
| `retryDelay` | `Duration` | Delay between retries. Default is `1s`. |
| `onError` | `Function(err)`| Callback executed when a query fails (after retries). |

## Examples

### Retries & Backoff
Retry failed requests automatically to handle flaky networks.

```dart
QueryOptions(
  retry: 3,
  retryDelay: Duration(seconds: 2), // Wait 2s between attempts
)
```

### Global Error Effects
Show a snackbar whenever *any* query fails.

```dart
// Using QueryClientObserver
class GlobalErrorHandler extends QueryClientObserver {
  @override
  void onQueryError(Query query, Object error) {
    showToast('Something went wrong: $error');
  }
}

// Register it
client.addObserver(GlobalErrorHandler());
```

### Manual Retry Button
Give users a way to try again.

```dart
if (state.hasError) {
  return Column(
    children: [
      Text('Failed to load'),
      ElevatedButton(
        // Invalidating triggers a refetch
        onPressed: () => QueryClient().invalidateQuery('my-key'.toQueryKey()),
        child: Text('Retry'),
      )
    ],
  );
}
```
